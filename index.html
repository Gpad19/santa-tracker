<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Santa Tracker</title>
<script src="https://cdn.jsdelivr.net/npm/cesium@1.113/Build/Cesium/Cesium.js"></script>
<link href="https://cdn.jsdelivr.net/npm/cesium@1.113/Build/Cesium/Widgets/widgets.css" rel="stylesheet">
<style>
html, body, #cesiumContainer {
    width: 100%; height: 100%; margin: 0; padding: 0; overflow: hidden;
}
.label {
    position: absolute;
    top: 10px; left: 10px;
    padding: 10px;
    background: rgba(0,0,0,0.5);
    color: white;
    border-radius: 5px;
    font-family: sans-serif;
    z-index: 100;
}
</style>
</head>
<body>
<div id="cesiumContainer"></div>
<div class="label">ðŸŽ… Santa Tracker</div>

<script>
// --- REQUIRED: Cesium Ion token ---
Cesium.Ion.defaultAccessToken = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiJiZjEyOGQ2Mi1jMGUwLTRhNmMtYThhZi1lYTcyMzAwYWFiMDYiLCJpZCI6MTIxODQ5LCJpYXQiOjE2NzQxNjE4MDh9.-_OgfjufhglZ0BdQkgwdlNqABiJNfe61EzpscAFljBE';

// Initialize viewer with Cesium Ion imagery (CORS-enabled)
const viewer = new Cesium.Viewer('cesiumContainer', {
    imageryProvider: Cesium.createWorldImagery(), // Ion imagery
    baseLayerPicker: false,
    timeline: false,
    animation: false,
    scene3DOnly: true,
    shouldAnimate: true
});

// Create a smooth Santa flight path
const santaPathCoordinates = [];
for (let lon = -180; lon <= 180; lon += 2) {
    const lat = 30 * Math.sin((lon / 180) * Math.PI); // wavy path
    santaPathCoordinates.push([lon, lat]);
}

// Create a SampledPositionProperty for smooth animation
const santaPosition = new Cesium.SampledPositionProperty();
const startTime = Cesium.JulianDate.now();
santaPathCoordinates.forEach((coord, i) => {
    const time = Cesium.JulianDate.addSeconds(startTime, i * 2, new Cesium.JulianDate());
    const position = Cesium.Cartesian3.fromDegrees(coord[0], coord[1], 1500000);
    santaPosition.addSample(time, position);
});

// Loop the Santa animation
const totalDuration = santaPathCoordinates.length * 2; // seconds
viewer.clock.startTime = startTime.clone();
viewer.clock.currentTime = startTime.clone();
viewer.clock.multiplier = 1;
viewer.clock.clockRange = Cesium.ClockRange.LOOP_STOP;
viewer.clock.shouldAnimate = true;
viewer.clock.stopTime = Cesium.JulianDate.addSeconds(startTime, totalDuration, new Cesium.JulianDate());

// Add Santa entity
const santa = viewer.entities.add({
    id: 'santa',
    name: "Santa",
    position: santaPosition,
    billboard: {
        image: "https://upload.wikimedia.org/wikipedia/commons/1/1e/Santa_Claus_icon.svg",
        scale: 0.12,
        verticalOrigin: Cesium.VerticalOrigin.BOTTOM
    },
    label: {
        text: "ðŸŽ… Santa",
        font: "24px sans-serif",
        verticalOrigin: Cesium.VerticalOrigin.TOP,
        pixelOffset: new Cesium.Cartesian2(0, -30)
    }
});

// Camera follows Santa
viewer.trackedEntity = santa;

// Touch-friendly camera
viewer.scene.screenSpaceCameraController.enableRotate = true;
viewer.scene.screenSpaceCameraController.enableTranslate = true;
viewer.scene.screenSpaceCameraController.enableZoom = true;
viewer.scene.screenSpaceCameraController.enableTilt = true;
viewer.scene.screenSpaceCameraController.enableLook = true;

// Handle iPad resize
window.addEventListener('resize', () => viewer.resize());
</script>
</body>
</html>

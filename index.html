<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Santa Tracker ğŸ…</title>

  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />

  <!-- Cesium -->
  <script src="https://cesium.com/downloads/cesiumjs/releases/1.115/Build/Cesium/Cesium.js"></script>
  <link href="https://cesium.com/downloads/cesiumjs/releases/1.115/Build/Cesium/Widgets/widgets.css"
        rel="stylesheet" />

  <style>
    html, body, #cesiumContainer {
      width: 100%;
      height: 100%;
      margin: 0;
      padding: 0;
      overflow: hidden;
      background: black;
    }

    #info {
      position: absolute;
      top: 12px;
      left: 12px;
      background: rgba(0, 0, 0, 0.65);
      color: white;
      padding: 14px 18px;
      border-radius: 12px;
      font-family: system-ui, -apple-system;
      font-size: 14px;
      z-index: 10;
      min-width: 240px;
      line-height: 1.5;
    }

    #zoomSanta {
      position: absolute;
      top: 140px;
      left: 12px;
      padding: 10px 14px;
      border-radius: 10px;
      border: none;
      background: rgba(255, 0, 0, 0.85);
      color: white;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      z-index: 10;
    }

    #zoomSanta:hover {
      background: rgba(255, 0, 0, 1);
    }
  </style>
</head>

<body>

<div id="cesiumContainer"></div>
<div id="info">ğŸ… Preparing for departureâ€¦</div>
<button id="zoomSanta">ğŸ… Zoom to Santa</button>

<script>
/* =====================================
   ğŸ”‘ Cesium ion token
===================================== */
Cesium.Ion.defaultAccessToken =
  "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiJiZjEyOGQ2Mi1jMGUwLTRhNmMtYThhZi1lYTcyMzAwYWFiMDYiLCJpZCI6MTIxODQ5LCJpYXQiOjE2NzQxNjE4MDh9.-_OgfjufhglZ0BdQkgwdlNqABiJNfe61EzpscAFljBE";

/* =====================================
   ğŸŒ Viewer
===================================== */
const viewer = new Cesium.Viewer("cesiumContainer", {
  animation: true,
  timeline: true,
  shouldAnimate: true
});

viewer.scene.globe.enableLighting = true;

/* =====================================
   â° Timeline
===================================== */
const santaStart = Cesium.JulianDate.fromIso8601("2026-12-24T11:00:00Z");
const santaEnd   = Cesium.JulianDate.fromIso8601("2026-12-25T10:00:00Z");

/* =====================================
   ğŸ™ Cities
===================================== */
const cities = [
  { name: "North Pole,Arctic", lon: -135, lat: 90, stop: 0 },
  { name: "Uelen,Russia", lon: -169.8098, lat: 66.1597, stop: 0 },
  { name: "Auckland,New Zealand", lon: 174.76, lat: -36.85, stop: 0 },
  { name: "Wellington,New Zealand", lon: 174.78, lat: -41.29, stop: 0 },
  { name: "Sydney", lon: 151.2, lat: -33.8, stop: 0 },
  { name: "Melbourne", lon: 144.96, lat: -37.81, stop: 0 },
  { name: "Brisbane", lon: 153.02, lat: -27.47, stop: 0 },
  { name: "Port Moresby", lon: 147.18, lat: -9.44, stop: 0 },
  { name: "Tokyo", lon: 139.7, lat: 35.7, stop: 0 },
  { name: "Osaka", lon: 135.5, lat: 34.69, stop: 0 },
  { name: "Seoul", lon: 126.98, lat: 37.56, stop: 0 },
  { name: "Taipei", lon: 121.56, lat: 25.03, stop: 0 },
  { name: "Manila", lon: 120.98, lat: 14.6, stop: 0 },
  { name: "Hong Kong", lon: 114.17, lat: 22.32, stop: 0 },
  { name: "Beijing", lon: 116.4, lat: 39.9, stop: 0 },
  { name: "Shanghai", lon: 121.47, lat: 31.23, stop: 0 },
  { name: "Hanoi", lon: 105.85, lat: 21.03, stop: 0 },
  { name: "Ho Chi Minh City", lon: 106.63, lat: 10.82, stop: 0 },
  { name: "Jakarta", lon: 106.85, lat: -6.21, stop: 0 },
  { name: "Singapore", lon: 103.82, lat: 1.35, stop: 0 },
  { name: "Kuala Lumpur", lon: 101.69, lat: 3.14, stop: 0 },
  { name: "Bangkok", lon: 100.5, lat: 13.75, stop: 0 },
  { name: "Phnom Penh", lon: 104.93, lat: 11.56, stop: 0 },
  { name: "Kathmandu", lon: 85.32, lat: 27.71, stop: 0 },
  { name: "Dhaka", lon: 90.41, lat: 23.81, stop: 0 },
  { name: "Mumbai", lon: 72.87, lat: 19.07, stop: 0 },
  { name: "Delhi", lon: 77.21, lat: 28.61, stop: 0 },
  { name: "Colombo", lon: 79.86, lat: 6.93, stop: 0 },
  { name: "Tashkent", lon: 69.24, lat: 41.31, stop: 0 },
  { name: "Almaty", lon: 76.88, lat: 43.24, stop: 0 },
  { name: "Tehran", lon: 51.39, lat: 35.69, stop: 0 },
  { name: "Baghdad", lon: 44.36, lat: 33.31, stop: 0 },
  { name: "Dubai", lon: 55.27, lat: 25.2, stop: 0 },
  { name: "Riyadh", lon: 46.71, lat: 24.71, stop: 0 },
  { name: "Jerusalem", lon: 35.21, lat: 31.77, stop: 0 },
  { name: "Cairo", lon: 31.23, lat: 30.04, stop: 0 },
  { name: "Addis Ababa", lon: 38.74, lat: 9.03, stop: 0 },
  { name: "Nairobi", lon: 36.82, lat: -1.29, stop: 0 },
  { name: "Cape Town", lon: 18.42, lat: -33.92, stop: 0 },
  { name: "Lagos", lon: 3.38, lat: 6.52, stop: 0 },
  { name: "Accra", lon: -0.2, lat: 5.56, stop: 0 },
  { name: "Casablanca", lon: -7.59, lat: 33.57, stop: 0 },
  { name: "Lisbon", lon: -9.14, lat: 38.72, stop: 0 },
  { name: "Madrid", lon: -3.7, lat: 40.42, stop: 0 },
  { name: "Barcelona", lon: 2.17, lat: 41.38, stop: 0 },
  { name: "Paris", lon: 2.35, lat: 48.86, stop: 0 },
  { name: "Brussels", lon: 4.35, lat: 50.85, stop: 0 },
  { name: "Amsterdam", lon: 4.9, lat: 52.37, stop: 0 },
  { name: "Berlin", lon: 13.41, lat: 52.52, stop: 0 },
  { name: "Vienna", lon: 16.37, lat: 48.21, stop: 0 },
  { name: "Rome", lon: 12.49, lat: 41.89, stop: 0 },
  { name: "Zurich", lon: 8.54, lat: 47.37, stop: 0 },
  { name: "Oslo", lon: 10.75, lat: 59.91, stop: 0 },
  { name: "Stockholm", lon: 18.07, lat: 59.33, stop: 0 },
  { name: "Helsinki", lon: 24.94, lat: 60.17, stop: 0 },
  { name: "Copenhagen", lon: 12.57, lat: 55.68, stop: 0 },
  { name: "Warsaw", lon: 21.01, lat: 52.23, stop: 0 },
  { name: "Prague", lon: 14.44, lat: 50.08, stop: 0 },
  { name: "Budapest", lon: 19.04, lat: 47.5, stop: 0 },
  { name: "Athens", lon: 23.73, lat: 37.98, stop: 0 },
  { name: "Istanbul", lon: 28.97, lat: 41.01, stop: 0 },
  { name: "London", lon: -0.1, lat: 51.5, stop: 0 },
  { name: "Dublin", lon: -6.26, lat: 53.35, stop: 0 },
  { name: "Reykjavik", lon: -21.82, lat: 64.13, stop: 0 },
  { name: "Miami", lon: -80.19, lat: 25.76, stop: 0 },
  { name: "New York", lon: -74.0, lat: 40.7, stop: 0 },
  { name: "Toronto", lon: -79.38, lat: 43.65, stop: 0 },
  { name: "Chicago", lon: -87.63, lat: 41.88, stop: 0 },
  { name: "Denver", lon: -104.99, lat: 39.74, stop: 0 },
  { name: "Los Angeles", lon: -118.24, lat: 34.05, stop: 0 },
  { name: "Anchorage", lon: -149.9, lat: 61.2, stop: 0 },
  { name: "Honolulu", lon: -157.86, lat: 21.31, stop: 0 },
  { name: "Return to North Pole", lon: -135, lat: 90, stop: 0 }
];

/* =====================================
   ğŸ§® Timing
===================================== */
const totalSeconds =
  Cesium.JulianDate.secondsDifference(santaEnd, santaStart);

const totalStopSeconds =
  cities.reduce((s, c) => s + c.stop, 0);

const travelPerLeg =
  (totalSeconds - totalStopSeconds) / (cities.length - 1);

/* =====================================
   ğŸ“ Movement path
===================================== */
const position = new Cesium.SampledPositionProperty();
let t = santaStart.clone();
const arcSamples = 96;

cities.forEach((city, i) => {
  city.arrival = t.clone();
  const p = Cesium.Cartesian3.fromDegrees(city.lon, city.lat, 80000);
  position.addSample(city.arrival, p);

  t = Cesium.JulianDate.addSeconds(t, city.stop, new Cesium.JulianDate());
  city.departure = t.clone();
  position.addSample(city.departure, p);

  if (i < cities.length - 1) {
    const next = cities[i + 1];
    const geo = new Cesium.EllipsoidGeodesic(
      Cesium.Cartographic.fromDegrees(city.lon, city.lat),
      Cesium.Cartographic.fromDegrees(next.lon, next.lat)
    );

    for (let j = 1; j <= arcSamples; j++) {
      const f = j / arcSamples;
      const c = geo.interpolateUsingFraction(f);
      const h = 80000 + Math.sin(Math.PI * f);

      const tt = Cesium.JulianDate.addSeconds(
        city.departure,
        travelPerLeg * f,
        new Cesium.JulianDate()
      );

      position.addSample(
        tt,
        Cesium.Cartesian3.fromRadians(c.longitude, c.latitude, h)
      );
    }

    t = Cesium.JulianDate.addSeconds(t, travelPerLeg, new Cesium.JulianDate());
  }
});

/* =====================================
   ğŸ… Santa entity (NO PATH)
===================================== */
const santa = viewer.entities.add({
  availability: new Cesium.TimeIntervalCollection([
    new Cesium.TimeInterval({ start: santaStart, stop: santaEnd })
  ]),
  position,
  point: {
    pixelSize: 12,
    color: Cesium.Color.RED,
    outlineColor: Cesium.Color.WHITE,
    outlineWidth: 2
  },
  path: {
    show: false
  }
});

viewer.trackedEntity = santa;

/* =====================================
   ğŸ“¢ Status + Countdown
===================================== */
const info = document.getElementById("info");

function formatCountdown(seconds) {
  seconds = Math.max(0, Math.floor(seconds));
  const h = String(Math.floor(seconds / 3600)).padStart(2, "0");
  const m = String(Math.floor((seconds % 3600) / 60)).padStart(2, "0");
  const s = String(seconds % 60).padStart(2, "0");
  return `${h}:${m}:${s}`;
}

viewer.clock.startTime = santaStart.clone();
viewer.clock.stopTime = santaEnd.clone();
viewer.clock.clockRange = Cesium.ClockRange.CLAMPED;
viewer.clock.clockStep = Cesium.ClockStep.SYSTEM_CLOCK;

viewer.clock.onTick.addEventListener(clock => {
  const now = clock.currentTime;

  if (Cesium.JulianDate.lessThan(now, santaStart)) {
    info.innerHTML = "ğŸ… Preparing for departureâ€¦";
    return;
  }

  if (Cesium.JulianDate.greaterThan(now, santaEnd)) {
    info.innerHTML = "ğŸ„ Santa has completed deliveries!";
    return;
  }

  for (let i = 0; i < cities.length - 1; i++) {
    if (
      Cesium.JulianDate.lessThanOrEquals(cities[i].arrival, now) &&
      Cesium.JulianDate.greaterThan(cities[i + 1].arrival, now)
    ) {
      const next = cities[i + 1];
      const seconds =
        Cesium.JulianDate.secondsDifference(next.arrival, now);

      info.innerHTML = `
        ğŸ… Santa is in<br>
        <strong>${cities[i].name}</strong><br><br>
        ğŸ¯ Next stop: <strong>${next.name}</strong><br>
        â³ Arrival in: <strong>${formatCountdown(seconds)}</strong>
      `;
      break;
    }
  }
});

/* =====================================
   ğŸ¥ Zoom button
===================================== */
document.getElementById("zoomSanta").onclick = () => {
  viewer.trackedEntity = santa;
};

/* =====================================
   ğŸ¥ Initial camera
===================================== */
viewer.camera.flyTo({
  destination: Cesium.Cartesian3.fromDegrees(-135, 80, 3_000_000)
});
</script>

</body>
</html>

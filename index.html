<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Real-Time Santa Tracker ðŸŽ…</title>

  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />

  <script src="https://cesium.com/downloads/cesiumjs/releases/1.115/Build/Cesium/Cesium.js"></script>
  <link href="https://cesium.com/downloads/cesiumjs/releases/1.115/Build/Cesium/Widgets/widgets.css"
        rel="stylesheet" />

  <style>
    html, body, #cesiumContainer {
      width: 100%;
      height: 100%;
      margin: 0;
      padding: 0;
      overflow: hidden;
    }

    #info {
      position: absolute;
      top: 10px;
      left: 10px;
      background: rgba(0,0,0,0.65);
      color: white;
      padding: 10px 14px;
      border-radius: 8px;
      font-family: system-ui, -apple-system;
      font-size: 14px;
      z-index: 10;
    }
  </style>
</head>
<body>

<div id="cesiumContainer"></div>
<div id="info">ðŸŽ… Santa is delivering gifts!</div>

<script>
  // =====================================
  // ðŸ”‘ Cesium ion Access Token (REQUIRED)
  // =====================================
  Cesium.Ion.defaultAccessToken = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiJiZjEyOGQ2Mi1jMGUwLTRhNmMtYThhZi1lYTcyMzAwYWFiMDYiLCJpZCI6MTIxODQ5LCJpYXQiOjE2NzQxNjE4MDh9.-_OgfjufhglZ0BdQkgwdlNqABiJNfe61EzpscAFljBE";

  const viewer = new Cesium.Viewer("cesiumContainer", {
    animation: false,
    timeline: false,
    baseLayerPicker: false,
    geocoder: false,
    homeButton: false,
    sceneModePicker: false,
    navigationHelpButton: false,
    fullscreenButton: false,
    shouldAnimate: true
  });

  viewer.scene.globe.enableLighting = true;
  viewer.scene.requestRenderMode = true;
  viewer.scene.maximumRenderTimeChange = Infinity;

  // =====================================
  // â° REAL-TIME CONFIGURATION
  // =====================================
  const santaStart = Cesium.JulianDate.fromIso8601("2026-12-24T00:00:00Z");
  const santaEnd   = Cesium.JulianDate.fromIso8601("2026-12-25T00:00:00Z");

  // Santa route (simplified world path)
  const route = [
    [-135, 90],   // North Pole
    [-100, 60],
    [-80, 40],
    [-50, 30],
    [-10, 20],
    [30, 10],
    [70, 25],
    [110, 35],
    [150, 50]
  ];

  // =====================================
  // ðŸ“ Build time-based position property
  // =====================================
  const position = new Cesium.SampledPositionProperty();

  const totalSeconds =
    Cesium.JulianDate.secondsDifference(santaEnd, santaStart);

  route.forEach((coord, i) => {
    const time = Cesium.JulianDate.addSeconds(
      santaStart,
      (totalSeconds / (route.length - 1)) * i,
      new Cesium.JulianDate()
    );

    position.addSample(
      time,
      Cesium.Cartesian3.fromDegrees(coord[0], coord[1], 300000)
    );
  });

  // =====================================
  // ðŸŽ… Santa entity
  // =====================================
  const santa = viewer.entities.add({
    availability: new Cesium.TimeIntervalCollection([
      new Cesium.TimeInterval({ start: santaStart, stop: santaEnd })
    ]),
    position,
    orientation: new Cesium.VelocityOrientationProperty(position),
    model: {
      uri: "https://cdn.jsdelivr.net/gh/AnalyticalGraphicsInc/cesium-assets@master/models/CesiumMan/Cesium_Man.glb",
      minimumPixelSize: 64
    },
    path: {
      width: 3,
      material: Cesium.Color.RED
    }
  });

  // =====================================
  // ðŸ•° Sync Cesium clock to REAL UTC TIME
  // =====================================
  viewer.clock.startTime = santaStart.clone();
  viewer.clock.stopTime = santaEnd.clone();
  viewer.clock.clockRange = Cesium.ClockRange.CLAMPED;
  viewer.clock.clockStep = Cesium.ClockStep.SYSTEM_CLOCK;

  viewer.trackedEntity = santa;

  viewer.camera.flyTo({
    destination: Cesium.Cartesian3.fromDegrees(-135, 80, 3_000_000)
  });
</script>

</body>
</html>

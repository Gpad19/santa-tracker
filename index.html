<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Santa Tracker - World Tour</title>

<script src="https://cesium.com/downloads/cesiumjs/releases/1.113/Build/Cesium/Cesium.js"></script>
<link href="https://cesium.com/downloads/cesiumjs/releases/1.113/Build/Cesium/Widgets/widgets.css" rel="stylesheet" />

<style>
html, body, #cesiumContainer {
  width:100%; height:100%; margin:0; background:#081a2b;
  overflow:hidden; font-family:system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
}
#hud {
  position:absolute; top:12px; left:12px; background:rgba(0,0,0,0.55);
  color:white; padding:12px 16px; border-radius:10px;
  backdrop-filter:blur(8px); font-size:14px; z-index:10;
}
#title { font-weight:600; margin-bottom:6px; font-size:16px; }
#snapButton {
  margin-top:6px; padding:6px 12px; background:#ff2d2d;
  border:none; border-radius:6px; color:white; font-weight:600;
  cursor:pointer;
}
#snapButton:hover { background:#ff5252; }
</style>
</head>

<body>
<div id="cesiumContainer"></div>

<div id="hud">
  <div id="title">üéÖ Santa Tracker</div>
  <div>Stops: <span id="stops">‚Äî</span></div>
  <div>Visited: <span id="visited">0</span></div>
  <div>Country: <span id="country">‚Äî</span></div>
  <div>City: <span id="city">‚Äî</span></div>
  <button id="snapButton">üìç Snap to Santa</button>
</div>

<script>
Cesium.Ion.defaultAccessToken = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiJiZjEyOGQ2Mi1jMGUwLTRhNmMtYThhZi1lYTcyMzAwYWFiMDYiLCJpZCI6MTIxODQ5LCJpYXQiOjE2NzQxNjE4MDh9.-_OgfjufhglZ0BdQkgwdlNqABiJNfe61EzpscAFljBE";

// -------------------------
// WORLD TOUR: Major cities
// -------------------------
const WORLD_ROUTE = [
  { country:"Afghanistan", cities:[["Kabul",34.52813,69.17233],["Kandahar",31.62887,65.73717]] },
  { country:"Albania", cities:[["Tirana",41.32755,19.81889],["Durr√´s",41.32313,19.44142]] },
  { country:"Algeria", cities:[["Algiers",36.73723,3.08628],["Oran",35.69694,-0.63386]] },
  { country:"Andorra", cities:[["Andorra la Vella",42.50779,1.52109],["Escaldes-Engordany",42.50750,1.53472]] },
  { country:"Angola", cities:[["Luanda",-8.83901,13.28940],["Huambo",-12.77609,15.73944]] },
  { country:"Antigua and Barbuda", cities:[["St. John's",17.12741,-61.84678],["All Saints",17.09721,-61.82035]] },
  { country:"Argentina", cities:[["Buenos Aires",-34.60372,-58.38159],["C√≥rdoba",-31.42008,-64.18878]] },
  { country:"Armenia", cities:[["Yerevan",40.17917,44.49910],["Gyumri",40.79403,43.84565]] },
  { country:"Australia", cities:[["Sydney",-33.86882,151.20929],["Melbourne",-37.81361,144.96306]] },
  { country:"Austria", cities:[["Vienna",48.20849,16.37208],["Graz",47.07071,15.43950]] },
  { country:"Azerbaijan", cities:[["Baku",40.40926,49.86709],["Ganja",40.68393,46.36056]] },
  { country:"Bahamas", cities:[["Nassau",25.04433,-77.35038],["Freeport",26.53376,-78.70049]] },
  { country:"Bahrain", cities:[["Manama",26.22350,50.58760],["Riffa",26.12480,50.58260]] },
  { country:"Bangladesh", cities:[["Dhaka",23.81033,90.41252],["Chittagong",22.35685,91.78318]] },
  { country:"Barbados", cities:[["Bridgetown",13.09699,-59.61450],["Speightstown",13.27547,-59.63897]] },
  { country:"Belarus", cities:[["Minsk",53.90226,27.56183],["Gomel",52.43450,30.97536]] },
  { country:"Belgium", cities:[["Brussels",50.85034,4.35171],["Antwerp",51.21945,4.40246]] },
  { country:"Belize", cities:[["Belize City",17.50462,-88.19624],["San Ignacio",17.15659,-89.07097]] },
  { country:"Benin", cities:[["Porto-Novo",6.49646,2.62893],["Cotonou",6.36589,2.41834]] },
  { country:"Bhutan", cities:[["Thimphu",27.47279,89.63901],["Phuntsholing",26.86450,89.38853]] },
  { country:"Bolivia", cities:[["La Paz",-16.48969,-68.11929],["Santa Cruz",-17.78333,-63.18211]] },
  { country:"Bosnia and Herzegovina", cities:[["Sarajevo",43.85643,18.41303],["Banja Luka",44.77219,17.19100]] },
  { country:"Botswana", cities:[["Gaborone",-24.62821,25.92315],["Francistown",-21.17024,27.50788]] },
  { country:"Brazil", cities:[["S√£o Paulo",-23.55052,-46.63331],["Rio de Janeiro",-22.90685,-43.17290]] },
  { country:"Brunei", cities:[["Bandar Seri Begawan",4.90305,114.93982],["Tutong",4.84131,114.96934]] },
  { country:"Bulgaria", cities:[["Sofia",42.69751,23.32415],["Plovdiv",42.13541,24.74529]] },
  { country:"Burkina Faso", cities:[["Ouagadougou",12.37143,-1.51966],["Bobo-Dioulasso",11.17712,-4.29701]] },
  { country:"Burundi", cities:[["Bujumbura",-3.36144,29.35988],["Gitega",-3.42639,29.93050]] },
  { country:"Cambodia", cities:[["Phnom Penh",11.55641,104.92821],["Siem Reap",13.36710,103.84480]] },
  { country:"Cameroon", cities:[["Yaound√©",3.84803,11.50208],["Douala",4.05107,9.76787]] },
  { country:"Canada", cities:[["Toronto",43.65323,-79.38318],["Montreal",45.50169,-73.56725]] },
  { country:"Cape Verde", cities:[["Praia",14.93305,-23.51333],["Mindelo",16.89079,-24.98040]] },
  { country:"Central African Republic", cities:[["Bangui",4.39467,18.55819],["Bouar",5.94056,17.46472]] },
  { country:"Chad", cities:[["N'Djamena",12.13484,15.05574],["Moundou",8.61056,16.08133]] },
  { country:"Chile", cities:[["Santiago",-33.44889,-70.66927],["Valpara√≠so",-33.04724,-71.61269]] },
  { country:"China", cities:[["Beijing",39.90420,116.40739],["Shanghai",31.23041,121.47370]] },
  { country:"Colombia", cities:[["Bogot√°",4.71100,-74.07209],["Medell√≠n",6.24434,-75.58121]] },
  { country:"Congo (Brazzaville)", cities:[["Brazzaville",-4.26336,15.24288],["Pointe-Noire",-4.82833,11.86667]] },
  { country:"Congo (Kinshasa)", cities:[["Kinshasa",-4.44193,15.26629],["Lubumbashi",-11.68759,27.47941]] },
  { country:"Costa Rica", cities:[["San Jos√©",9.92807,-84.09073],["Lim√≥n",9.99000,-83.03500]] },
  { country:"Croatia", cities:[["Zagreb",45.81501,15.97850],["Split",43.50813,16.44019]] },
  { country:"Cuba", cities:[["Havana",23.11359,-82.36659],["Santiago de Cuba",20.02466,-75.82192]] },
  { country:"Cyprus", cities:[["Nicosia",35.18556,33.38227],["Limassol",34.70713,33.02262]] },
  { country:"Czech Republic", cities:[["Prague",50.07554,14.43780],["Brno",49.19506,16.60684]] },
  { country:"Denmark", cities:[["Copenhagen",55.67594,12.56553],["Aarhus",56.16294,10.20392]] },
  // ... continue with the rest of the countries (~200 total)
];

// Flatten stops for Cesium
let stops = [];
WORLD_ROUTE.forEach(c => {
  c.cities.forEach(city => {
    stops.push({ country:c.country, name:city[0], lat:city[1], lon:city[2], entity:null, visited:false });
  });
});

document.getElementById("stops").textContent = stops.length;

const FLIGHT_HEIGHT = 40000;

// -------------------------
// Initialize Cesium
// -------------------------
(function initCesium() {
  const viewer = new Cesium.Viewer("cesiumContainer", {
    timeline:false, animation:false, baseLayerPicker:false,
    geocoder:false, homeButton:false, sceneModePicker:false,
    fullscreenButton:false, navigationHelpButton:false, shouldAnimate:true
  });

  viewer.scene.globe.depthTestAgainstTerrain = false;

  // Santa path
  const santaPosition = new Cesium.SampledPositionProperty();
  const startTime = Cesium.JulianDate.now();
  const secondsPerStop = 24*60*60 / stops.length;

  stops.forEach((stop,i)=>{
    const t = Cesium.JulianDate.addSeconds(startTime,i*secondsPerStop,new Cesium.JulianDate());
    santaPosition.addSample(t, Cesium.Cartesian3.fromDegrees(stop.lon, stop.lat, FLIGHT_HEIGHT));
    stop.entity = viewer.entities.add({
      position: Cesium.Cartesian3.fromDegrees(stop.lon, stop.lat, FLIGHT_HEIGHT),
      point: { pixelSize:5, color:Cesium.Color.DARKGRAY, outlineColor:Cesium.Color.WHITE, outlineWidth:1 }
    });
  });

  // Santa red dot
  const santa = viewer.entities.add({
    position: santaPosition,
    point: { pixelSize:10, color:Cesium.Color.RED, outlineColor:Cesium.Color.WHITE, outlineWidth:1 }
  });

  // Clock
  viewer.clock.startTime = startTime.clone();
  viewer.clock.stopTime = Cesium.JulianDate.addSeconds(startTime,24*60*60,new Cesium.JulianDate());
  viewer.clock.currentTime = startTime.clone();
  viewer.clock.clockRange = Cesium.ClockRange.CLAMPED;
  viewer.clock.multiplier = 1;
  viewer.clock.shouldAnimate = true;
  viewer.trackedEntity = santa;

  // Free camera
  const c = viewer.scene.screenSpaceCameraController;
  c.enableRotate=true; c.enableZoom=true;
  c.enableTranslate=true; c.enableTilt=true; c.enableLook=true;

  viewer.camera.lookAt(santa.position.getValue(startTime), new Cesium.Cartesian3(-800000,0,40000));

  // Snap to Santa
  document.getElementById("snapButton").addEventListener("click", ()=>{
    const pos = santa.position.getValue(viewer.clock.currentTime);
    if(!pos) return;
    viewer.camera.flyToBoundingSphere(new Cesium.BoundingSphere(pos,40000), {duration:1.5});
  });

  // Cinematic orbit
  let orbitAngle=0;
  viewer.scene.postRender.addEventListener(()=>{
    const pos = santa.position.getValue(viewer.clock.currentTime);
    if(!pos) return;
    orbitAngle+=0.001;
    const offset = new Cesium.Cartesian3(-800000*Math.cos(orbitAngle), -800000*Math.sin(orbitAngle),40000);
    viewer.camera.lookAt(pos, Cesium.Cartesian3.lerp(viewer.camera.positionWC, offset,0.03,new Cesium.Cartesian3()));
  });

  // Registered stops like NORAD
  viewer.clock.onTick.addEventListener(()=>{
    const santaPos = santa.position.getValue(viewer.clock.currentTime);
    stops.forEach(stop=>{
      if(stop.visited) return;
      const stopPos = Cesium.Cartesian3.fromDegrees(stop.lon, stop.lat, FLIGHT_HEIGHT);
      if(santaPos && Cesium.Cartesian3.distance(santaPos,stopPos)<20000){
        stop.visited = true;
        stop.entity.point.color = Cesium.Color.LIME;
        stop.entity.point.pixelSize = 8;
        document.getElementById("visited").textContent = stops.filter(s=>s.visited).length;
        document.getElementById("country").textContent = stop.country;
        document.getElementById("city").textContent = stop.name;
      }
    });
  });

})();
</script>
</body>
</html>
